Mp = 135;
Mr = 5.5;
D = 0.6;
L = 1;
b = 0.03;
R = 0.2;
Jp = 27.6;
Jr = 0.11;
g = 9.8;

alpha = Mr * R ^ 2 / Jr + 1;
beta = Jp / (Mp * L) + L;
gama = L * Mp * g;
A22 = -R ^ 2 * b / (alpha * Jr);
A23 = -R ^ 2 * gama / (2 * Jr * alpha * beta);
B2 = R / (2 * Jr) * (1 / alpha + R / (alpha * beta));
A43 = gama / Jp - (L * gama) / (Jp * beta);
B4 = (L / beta - 1) / Jp;

A = [0 1 0 0; 0 A22 A23 0; 0 0 0 1; 0 0 A43 0];
B = [0;B2;0;B4];
C = [0 0 0 0;0 0 0 0;0 0 1 0;0 0 0 1];
D = [0;0;0;0];
Q = [300 0;0 1];
R = 1;
AA = [0 1;A43 0];
BB = [0;B4];
CC = [1 0;0 1];
[K, S, E] = lqr(AA,BB,Q,R);
